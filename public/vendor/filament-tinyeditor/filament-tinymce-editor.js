function ut({activePanel:et,state:b,statePath:E,selector:v,plugins:F,external_plugins:C,toolbar:A,text_patterns:$,language:O="en",language_url:U=null,directionality:T="ltr",height:x=null,max_height:z=0,min_height:M=100,width:k=null,max_width:_=0,min_width:I=400,resize:L=!1,skin:P="oxide",content_css:S="default",toolbar_sticky:B=!0,toolbar_sticky_offset:it=64,toolbar_mode:ot="sliding",toolbar_location:nt="auto",inline:st=!1,toolbar_persist:rt=!1,menubar:R=!1,font_size_formats:D="",fontfamily:K="",relative_urls:V=!0,image_list:W=null,image_advtab:G=!1,image_description:q=!1,image_class_list:H=null,images_upload_url:N=null,images_upload_base_path:j=null,remove_script_host:J=!0,convert_urls:Q=!0,custom_configs:X={},setup:m=null,disabled:at=!1,locale:lt="en",license_key:Y="gpl",placeholder:dt=null,removeImagesEventCallback:l=null,uploadingMessage:ct="Uploading image...",key:u}){let d=window.filamentTinyEditors||{},g=(t,r,Z={})=>{t.getContainer().closest("form")?.dispatchEvent(new CustomEvent(r,{composed:!0,cancelable:!0,detail:Z}))};return{activePanel:et,id:null,state:b,statePath:E,selector:v,language:O,language_url:U,directionality:T,height:x,max_height:z,min_height:M,width:k,max_width:_,min_width:I,resize:L,skin:P,content_css:S,plugins:F,external_plugins:C,toolbar:A,text_patterns:$,toolbar_sticky:B,menubar:R,relative_urls:V,remove_script_host:J,convert_urls:Q,font_size_formats:D,fontfamily:K,setup:m,image_list:W,image_advtab:G,image_description:q,image_class_list:H,images_upload_url:N,images_upload_base_path:j,license_key:Y,custom_configs:X,updatedAt:Date.now(),disabled:at,locale:lt,placeholder:dt,removeImagesEventCallback:l,isUploadingFile:!1,isModalOpen:!1,init(){this.delete(),this.tryInitializeEditor(b.initialValue),window.filamentTinyEditors=d,this.$watch("state",(t,r)=>{t==="<p></p>"&&t!==this.editor()?.getContent()&&(this.editor()&&this.editor().destroy(),this.initEditor(t)),this.editor()?.container&&t!==this.editor()?.getContent()&&(this.updateEditorContent(t||""),this.putCursorToEnd())}),window.addEventListener("rich-editor-uploading-file",t=>{t.detail.livewireId===this.$wire.id&&t.detail.key===u&&(this.isUploadingFile=!0,t.stopPropagation())}),window.addEventListener("rich-editor-uploaded-file",t=>{t.detail.livewireId===this.$wire.id&&t.detail.key===u&&(this.isUploadingFile=!1,t.stopPropagation())}),this.$el.closest(".fi-modal")?.addEventListener("open-modal",()=>{this.isModalOpen=!0,this.$nextTick(()=>this.tryInitializeEditor(this.state||""))}),this.$el.closest(".fi-modal")?.addEventListener("close-modal",()=>{this.isModalOpen=!1,this.delete()}),window.addEventListener("livewire:navigated",()=>{this.isModalOpen&&this.$nextTick(()=>this.tryInitializeEditor(this.state||""))})},editor(){return tinymce.get(d[this.statePath])},tryInitializeEditor(t){if(!document.querySelector(this.selector)){console.warn(`TinyMCE target node ${this.selector} not found. Retrying...`),setTimeout(()=>this.tryInitializeEditor(t),100);return}this.initEditor(t)},initEditor(t){let r=this,Z=this.$wire,tt=K||"Arial=arial,helvetica,sans-serif; Courier New=courier new,courier,monospace; AkrutiKndPadmini=Akpdmi-n",ft={selector:v,language:O,language_url:U,directionality:T,statusbar:!1,promotion:!1,height:x,max_height:z,min_height:M,width:k,max_width:_,min_width:I,resize:L,skin:P,content_css:S,plugins:F,external_plugins:C,toolbar:A,text_patterns:$,toolbar_sticky:B,toolbar_sticky_offset:it,toolbar_mode:ot,toolbar_location:nt,inline:st,toolbar_persist:rt,menubar:R,menu:{file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},font_size_formats:D||"8pt 10pt 12pt 14pt 16pt 18pt 24pt 36pt 48pt",fontfamily:tt,font_family_formats:tt,relative_urls:V,remove_script_host:J,convert_urls:Q,image_list:W,image_advtab:G,image_description:q,image_class_list:H,images_upload_url:N,images_upload_base_path:j,license_key:Y,...X,setup:function(e){window.tinySettingsCopy||(window.tinySettingsCopy=[]),e.settings&&!window.tinySettingsCopy.some(i=>i.id===e.settings.id)&&window.tinySettingsCopy.push(e.settings),e.on("blur",function(i){r.updatedAt=Date.now(),r.state=e.getContent()}),e.on("change",function(i){r.updatedAt=Date.now(),r.state=e.getContent()}),e.on("init",function(i){d[r.statePath]=e.id,t!=null&&e.setContent(t)}),e.on("OpenWindow",function(i){let s=i.target.container.closest(".fi-modal");s&&s.setAttribute("x-trap.noscroll","false")}),e.on("CloseWindow",function(i){let s=i.target.container.closest(".fi-modal");s&&s.setAttribute("x-trap.noscroll","isOpen")}),typeof m=="function"&&m(e)},images_upload_handler:(e,i)=>new Promise((s,c)=>{if(!e.blob()){c("No file provided");return}this.isUploadingFile=!0,g(this.editor(),"form-processing-started",{message:ct});let h=("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,o=>(o^crypto.getRandomValues(new Uint8Array(1))[0]&15>>o/4).toString(16));this.editor().getContainer().dispatchEvent(new CustomEvent("rich-editor-uploading-file",{bubbles:!0,detail:{key:u,livewireId:this.$wire.id}})),this.$wire.upload(`componentFileAttachments.${E}.${h}`,e.blob(),()=>{this.$wire.callSchemaComponentMethod(u,"getUploadedFileAttachmentTemporaryUrl",{attachment:h}).then(o=>{if(!o){c("Image upload failed - no URL returned"),this.isUploadingFile=!1;return}s(o),this.editor().getContainer().dispatchEvent(new CustomEvent("rich-editor-uploaded-file",{bubbles:!0,detail:{key:u,livewireId:this.$wire.id}})),g(this.editor(),"form-processing-finished"),this.isUploadingFile=!1}).catch(o=>{c("Failed to get uploaded file URL: "+o),this.isUploadingFile=!1})},o=>{c("Upload failed: "+o),this.isUploadingFile=!1,g(this.editor(),"form-processing-finished")},o=>{i(o.detail.progress*100)})}),init_instance_callback:function(e){var i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,s=l&&typeof l=="function";if(s){var c=new i(function(h,o){var a=[];h.forEach(function(f){Array.from(f.addedNodes).forEach(function(n){if(n.nodeName==="IMG"&&n.className!=="mce-clonedresizable"){if(a.indexOf(n.src)>=0)return;a.push(n.getAttribute("src"));return}var y=n.getElementsByTagName("img");Array.from(y).forEach(function(p){a.indexOf(p.src)>=0||a.push(p.getAttribute("src"))})})});var w=[];h.forEach(function(f){Array.from(f.removedNodes).forEach(function(n){if(n.nodeName==="IMG"&&n.className!=="mce-clonedresizable"){if(w.indexOf(n.src)>=0)return;w.push(n.getAttribute("src"));return}if(n.nodeType===1){var y=n.getElementsByTagName("img");Array.from(y).forEach(function(p){a.indexOf(p.src)>=0||a.push(p.getAttribute("src"))})}})}),w.forEach(function(f){a.indexOf(f)>=0||l&&typeof l=="function"&&l(f)})});c.observe(e.getBody(),{childList:!0,subtree:!0})}},automatic_uploads:!0};tinymce.init(ft)},updateEditorContent(t){this.editor().setContent(t)},putCursorToEnd(){this.editor().selection.select(this.editor().getBody(),!0),this.editor().selection.collapse(!1)},delete(){try{d[this.statePath]&&(this.editor().destroy(),delete d[this.statePath])}catch{console.log(d[this.statePath]),console.log(this.editor())}}}}export{ut as default};
